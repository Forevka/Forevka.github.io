__NUXT_JSONP__("/blog/aiogram-login-button", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az){return {data:[{article:{slug:"index",description:"Дружим aiogram логин с fastapi",title:"Логин кнопка для бота телеграм",date:"2022-09-06T00:00:00.000Z",tags:["aiogram","login","aiohttp"],image:"fastapi-aiogram.png",toc:[{id:aa,depth:2,text:ab}],body:{type:"root",children:[{type:b,tag:s,props:{},children:[{type:b,tag:G,props:{id:aa},children:[{type:b,tag:l,props:{href:"#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-login-button",ariaHidden:t,tabIndex:u},children:[{type:b,tag:c,props:{className:[v,w]},children:[]}]},{type:a,value:ab}]},{type:b,tag:j,props:{},children:[{type:b,tag:l,props:{href:"https:\u002F\u002Fcore.telegram.org\u002Fbots\u002Fapi#loginurl",rel:[x,y,z],target:A},children:[{type:a,value:"Ссылка на документацию телеграм"}]}]},{type:b,tag:j,props:{},children:[{type:a,value:"Приложение разбито на две составляющие "},{type:b,tag:l,props:{href:"https:\u002F\u002Fgithub.com\u002FForevka\u002FAiogram.Login.Example\u002Fblob\u002Fmain\u002Fbot.py",rel:[x,y,z],target:A},children:[{type:a,value:ac}]},{type:a,value:ad},{type:b,tag:l,props:{href:"https:\u002F\u002Fgithub.com\u002FForevka\u002FAiogram.Login.Example\u002Fblob\u002Fmain\u002Fweb.py",rel:[x,y,z],target:A},children:[{type:a,value:ae}]}]},{type:b,tag:j,props:{},children:[{type:a,value:"Читая эту статью вы должны ознакомиться с основами питона, здесь не будут разобраны тривиальные вопросы, например импорты в файлах и DI. Также я полагаю что вы уже ознакомились с фреймворками aiogram и fastapi которые были использованы в этом туториале."}]}]},{type:a,value:B},{type:b,tag:s,props:{},children:[{type:b,tag:L,props:{id:"подготовка-перед-запуском"},children:[{type:b,tag:l,props:{href:"#%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0-%D0%BF%D0%B5%D1%80%D0%B5%D0%B4-%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA%D0%BE%D0%BC",ariaHidden:t,tabIndex:u},children:[{type:b,tag:c,props:{className:[v,w]},children:[]}]},{type:a,value:"Подготовка перед запуском"}]},{type:b,tag:j,props:{},children:[{type:a,value:"После получения токена от бота вам нужно пойти в настройки этого бота, кнопка \"Bot Settings\" и перейти в раздел \"Domain\". В этом разделе нужно задать адрес на котором будет размещен веб сервис - тоесть то, куда будет переходить пользователь по нажатию на кнопку с login url"}]},{type:b,tag:s,props:{},children:[{type:b,tag:G,props:{id:"разбор-кода"},children:[{type:b,tag:l,props:{href:"#%D1%80%D0%B0%D0%B7%D0%B1%D0%BE%D1%80-%D0%BA%D0%BE%D0%B4%D0%B0",ariaHidden:t,tabIndex:u},children:[{type:b,tag:c,props:{className:[v,w]},children:[]}]},{type:a,value:"Разбор кода"}]}]}]},{type:a,value:B},{type:b,tag:s,props:{},children:[{type:b,tag:L,props:{id:ac},children:[{type:b,tag:l,props:{href:"#bot",ariaHidden:t,tabIndex:u},children:[{type:b,tag:c,props:{className:[v,w]},children:[]}]},{type:a,value:"Bot"}]},{type:b,tag:C,props:{className:[D]},children:[{type:b,tag:E,props:{className:[F,V]},children:[{type:b,tag:q,props:{},children:[{type:b,tag:c,props:{className:[d,"decorator","annotation",e]},children:[{type:a,value:"@dp"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:af}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:"commands"},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:H}]},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:ag}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ah}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:W}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:"cmd_login"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:af},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:" Message"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:ai}]},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:aj}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,"boolean"]},children:[{type:a,value:"None"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"\n    login_markup "},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:a,value:" InlineKeyboardMarkup"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:N}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:H}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"inline_keyboard\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:O}]},{type:a,value:X},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:O}]},{type:a,value:"\n                InlineKeyboardButton"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:N}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:H}]},{type:a,value:P},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"login_url\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:" LoginUrl"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:N}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:H}]},{type:a,value:"\n                        "},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"url\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,"string-interpolation"]},children:[{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"f\""}]},{type:b,tag:c,props:{className:[d,"interpolation"]},children:[{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:H}]},{type:a,value:"HOST_URL"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]}]},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\u002Fauth\""}]}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:P},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:P},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"text\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:ag}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:"\n                "},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:X},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:Q}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:Q}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:"await"}]},{type:a,value:" message"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"answer"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"Here login button\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:" reply_markup"},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:a,value:"login_markup"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:B}]}]}]},{type:b,tag:j,props:{},children:[{type:a,value:"Хендлер который реагирует на команду "},{type:b,tag:q,props:{},children:[{type:a,value:ak}]},{type:a,value:", он отправляет простое сообщение с кнопкой которая переадресовывает пользователя на ваш сайт.\nСобственно со стороны бота это весь нужный нам код."}]}]},{type:a,value:B},{type:b,tag:s,props:{},children:[{type:b,tag:L,props:{id:ae},children:[{type:b,tag:l,props:{href:"#web",ariaHidden:t,tabIndex:u},children:[{type:b,tag:c,props:{className:[v,w]},children:[]}]},{type:a,value:"Web"}]},{type:b,tag:C,props:{className:[D]},children:[{type:b,tag:E,props:{className:[F,V]},children:[{type:b,tag:q,props:{},children:[{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:W}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:"check_user_data"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:al},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:" TelegramAuthModel"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:" token"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"\n    secret "},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:a,value:" hashlib"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:am},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:"\n    secret"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"update"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:d},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:an},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:"\n    sorted_params "},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:a,value:" collections"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"OrderedDict"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,K]},children:[{type:a,value:"sorted"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:al},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,K]},children:[{type:a,value:ap}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aq},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:"\n    msg "},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"\\n\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"join"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:O}]},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"{}={}\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,K]},children:[{type:a,value:"format"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:"k"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:" v"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:P},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:"for"}]},{type:a,value:" k"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:" v "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:"in"}]},{type:a,value:" sorted_params"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aq},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:S}]},{type:a,value:" k "},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:"!="}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"'hash'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:Q}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ar}]},{type:a,value:" data"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,K]},children:[{type:a,value:"hash"}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:Z}]},{type:a,value:" hmac"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"new"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:"secret"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"digest"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:" msg"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:an},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:" digestmod"},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:a,value:"hashlib"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:am},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"hexdigest"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:"\n\n"}]}]}]},{type:b,tag:j,props:{},children:[{type:a,value:"Функция которая проводит валидацию данных переданных от пользователя. Это нужно для того что-бы убедиться что данные пришли действительно от телеграма и юзер их не придумал сам. Алгоритм можно найти "},{type:b,tag:l,props:{href:"https:\u002F\u002Fcore.telegram.org\u002Fwidgets\u002Flogin#checking-authorization",rel:[x,y,z],target:A},children:[{type:a,value:"тут"}]},{type:a,value:", а начальный код был взят отсюда "},{type:b,tag:l,props:{href:"https:\u002F\u002Fgist.github.com\u002FJrooTJunior\u002F887791de7273c9df5277d2b1ecadc839",rel:[x,y,z],target:A},children:[{type:a,value:"JRootJunior"}]},{type:a,value:" правда там есть баг, оставляю найти его и другие различия для читателя."}]},{type:b,tag:C,props:{className:[D]},children:[{type:b,tag:E,props:{className:[F,V]},children:[{type:b,tag:q,props:{},children:[{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ah}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:W}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:"login_route"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:"request"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:" Request"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:" user"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:" TelegramAuthModel "},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:a,value:" Depends"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:ai}]},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:aj}]},{type:a,value:" Response"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:S}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:"ENVIRONMENT"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"lower"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"strip"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:Z}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"production\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:S}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:"not"}]},{type:a,value:" check_user_data"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:" BOT_TOKEN"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:X},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:as}]},{type:a,value:at},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:"status_code"},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,_]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:av},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"Nice try hacker :D\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:"\n\n    user_from_database "},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:a,value:" FakeRepo"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"get_user"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,K]},children:[{type:a,value:"id"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:S}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:"user_from_database"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:O}]},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"role_id\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:Q}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:Z}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,_]},children:[{type:a,value:"2"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:as}]},{type:a,value:at},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:a,value:"\n            status_code"},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,_]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:av},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"Sorry you don't have permission\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ar}]},{type:a,value:" templates"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"TemplateResponse"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"login.html\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:H}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"\"request\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:" request"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:N}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,K]},children:[{type:a,value:ap}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:f}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:g}]},{type:a,value:B}]}]}]},{type:b,tag:j,props:{},children:[{type:a,value:"Самый интересный кусок кода, это функция которая выступает обработчиком роута для логина пользователя. Именно она будет вызвана после \"нажатия\" пользователем кнопки login.\nЗдесь я валидирую данные, проверяю его роль и на основе этого возвращаю ответ.\nПредполагается что "},{type:b,tag:q,props:{},children:[{type:a,value:"FakeRepo"}]},{type:a,value:" будет заменена на конкретную(другую) имплементацию общения с базой, здесь это выступает как пример алгоритма."}]},{type:b,tag:s,props:{},children:[{type:b,tag:G,props:{id:"config-env"},children:[{type:b,tag:l,props:{href:"#config-env",ariaHidden:t,tabIndex:u},children:[{type:b,tag:c,props:{className:[v,w]},children:[]}]},{type:a,value:"Config .env"}]},{type:b,tag:C,props:{className:[D]},children:[{type:b,tag:E,props:{className:[F,"language-text"]},children:[{type:b,tag:q,props:{},children:[{type:a,value:"ENVIRONMENT = getenv(\"env\", \"debug\")\n\nBOT_TOKEN = getenv(\"bot_token\", \"Aa:123\")\nHOST_URL = getenv(\"host_url\", \"\")\n"}]}]}]},{type:b,tag:j,props:{},children:[{type:a,value:"Тривиально, задаём токен от бота и хост на котором будут запускаться сервисы.\nHOST_URL должен быть белым, тоесть доступным всем в интернете, адресом."}]}]},{type:b,tag:s,props:{},children:[{type:b,tag:G,props:{id:"как-это-запустить"},children:[{type:b,tag:l,props:{href:"#%D0%BA%D0%B0%D0%BA-%D1%8D%D1%82%D0%BE-%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D1%82%D0%B8%D1%82%D1%8C",ariaHidden:t,tabIndex:u},children:[{type:b,tag:c,props:{className:[v,w]},children:[]}]},{type:a,value:"Как это запустить?"}]},{type:b,tag:j,props:{},children:[{type:a,value:"Бот работает в режиме "},{type:b,tag:l,props:{href:"https:\u002F\u002Fcore.telegram.org\u002Fbots\u002Fapi#getupdates",rel:[x,y,z],target:A},children:[{type:a,value:"long polling"}]},{type:a,value:" и ему не нужен белый айпи в отличие от веб сервиса."}]}]}]},{type:a,value:B},{type:b,tag:s,props:{},children:[{type:b,tag:L,props:{id:"ручной-запуск"},children:[{type:b,tag:l,props:{href:"#%D1%80%D1%83%D1%87%D0%BD%D0%BE%D0%B9-%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA",ariaHidden:t,tabIndex:u},children:[{type:b,tag:c,props:{className:[v,w]},children:[]}]},{type:a,value:"Ручной запуск"}]},{type:b,tag:j,props:{},children:[{type:a,value:"Установка зависимостей"}]},{type:b,tag:C,props:{className:[D]},children:[{type:b,tag:E,props:{className:[F,U]},children:[{type:b,tag:q,props:{},children:[{type:a,value:"pip "},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:"install"}]},{type:a,value:" -r requirements.txt\n"}]}]}]},{type:b,tag:j,props:{},children:[{type:a,value:"Bot, "},{type:b,tag:aw,props:{},children:[{type:a,value:ax}]}]},{type:b,tag:C,props:{className:[D]},children:[{type:b,tag:E,props:{className:[F,U]},children:[{type:b,tag:q,props:{},children:[{type:a,value:"python bot.py\n"}]}]}]},{type:b,tag:j,props:{},children:[{type:a,value:"Web построен на fastapi и для него нужен uvicorn, "},{type:b,tag:aw,props:{},children:[{type:a,value:ax}]}]},{type:b,tag:C,props:{className:[D]},children:[{type:b,tag:E,props:{className:[F,U]},children:[{type:b,tag:q,props:{},children:[{type:a,value:"uvicorn web:app --reload\n"}]}]}]}]},{type:a,value:B},{type:b,tag:s,props:{},children:[{type:b,tag:L,props:{id:"docker"},children:[{type:b,tag:l,props:{href:"#docker",ariaHidden:t,tabIndex:u},children:[{type:b,tag:c,props:{className:[v,w]},children:[]}]},{type:a,value:"Docker"}]},{type:b,tag:j,props:{},children:[{type:a,value:"Конфигурация написана в "},{type:b,tag:l,props:{href:"https:\u002F\u002Fgithub.com\u002FForevka\u002FAiogram.Login.Example\u002Fblob\u002Fmain\u002Fdocker-compose.yml",rel:[x,y,z],target:A},children:[{type:a,value:"компоуз файле"}]},{type:a,value:i}]},{type:b,tag:C,props:{className:[D]},children:[{type:b,tag:E,props:{className:[F,U]},children:[{type:b,tag:q,props:{},children:[{type:a,value:"docker-compose up\n"}]}]}]},{type:b,tag:j,props:{},children:[{type:a,value:"Всё остальное произойдёт само."}]},{type:b,tag:s,props:{},children:[{type:b,tag:G,props:{id:"использование"},children:[{type:b,tag:l,props:{href:"#%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5",ariaHidden:t,tabIndex:u},children:[{type:b,tag:c,props:{className:[v,w]},children:[]}]},{type:a,value:"Использование"}]},{type:b,tag:j,props:{},children:[{type:a,value:"После запуска веб сервисе перейдите на "},{type:b,tag:q,props:{},children:[{type:a,value:ay}]},{type:a,value:"\u002Fdocs - вы должны увидеть swagger документацию, пример ниже на скрине"}]},{type:b,tag:j,props:{},children:[{type:b,tag:$,props:{alt:"swagger",src:"https:\u002F\u002Fgithub.com\u002FForevka\u002FAiogram.Login.Example\u002Fblob\u002Fmain\u002Fimgs\u002Fswagger-ex.PNG?raw=true"},children:[]}]},{type:b,tag:j,props:{},children:[{type:a,value:"Если вы видите такое же на своём экране то скорее всего всё отлично!"}]},{type:b,tag:j,props:{},children:[{type:a,value:"После этого вы должны зайти в бота и отправить ему команду "},{type:b,tag:q,props:{},children:[{type:a,value:ak}]},{type:a,value:" в ответ вы получите сообщение с кнопкой логина"}]},{type:b,tag:j,props:{},children:[{type:b,tag:$,props:{alt:"login-button",src:"https:\u002F\u002Fgithub.com\u002FForevka\u002FAiogram.Login.Example\u002Fblob\u002Fmain\u002Fimgs\u002Flogin-ex.PNG?raw=true"},children:[]}]},{type:b,tag:j,props:{},children:[{type:a,value:"После нажатия на эту кнопку вы будете перенаправлены на "},{type:b,tag:q,props:{},children:[{type:a,value:ay}]},{type:a,value:"\u002Fauth и увидите данный экран"}]},{type:b,tag:j,props:{},children:[{type:b,tag:$,props:{alt:T,src:"https:\u002F\u002Fgithub.com\u002FForevka\u002FAiogram.Login.Example\u002Fblob\u002Fmain\u002Fimgs\u002Fuser-ex.PNG?raw=true"},children:[]}]},{type:b,tag:j,props:{},children:[{type:a,value:"Здесь будет та информация о пользователе которую предоставил вам телеграм. Весь набор полей "},{type:b,tag:l,props:{href:"https:\u002F\u002Fgithub.com\u002FForevka\u002FAiogram.Login.Example\u002Fblob\u002Fmain\u002Fmodels.py",rel:[x,y,z],target:A},children:[{type:a,value:"можно найти в специальной моделе"}]}]}]},{type:b,tag:s,props:{},children:[{type:b,tag:G,props:{id:"итог"},children:[{type:b,tag:l,props:{href:"#%D0%B8%D1%82%D0%BE%D0%B3",ariaHidden:t,tabIndex:u},children:[{type:b,tag:c,props:{className:[v,w]},children:[]}]},{type:a,value:"Итог"}]},{type:b,tag:j,props:{},children:[{type:a,value:"Здесь был реализован минимальный пример для работы с login button используя современные фреймворки "},{type:b,tag:l,props:{href:"https:\u002F\u002Fgithub.com\u002Faiogram\u002Faiogram\u002Ftree\u002Fdev-3.x",rel:[x,y,z],target:A},children:[{type:a,value:"aiogram v3"}]},{type:a,value:ad},{type:b,tag:l,props:{href:"https:\u002F\u002Ffastapi.tiangolo.com\u002F",rel:[x,y,z],target:A},children:[{type:a,value:"fast-api"}]},{type:a,value:"\nБезусловно это решение не является единственно верным и правильним, жду ваших PR если у вас есть замечания и предложения."}]}]}]}]},dir:"\u002Faiogram-login-button",path:"\u002Faiogram-login-button\u002Findex",extension:".md",createdAt:az,updatedAt:az,readingTime:"3 min read"},moreStories:[{title:"Hello World!",image:"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1024\u002F0*AotcC6GhXMHgyjmz.png",path:"\u002Fhello-world\u002Findex"}]}],fetch:{},mutations:void 0}}("text","element","span","token","punctuation","(",")","operator",".","p"," ","a","string","keyword",":",",","code","=","section","true",-1,"icon","icon-link","nofollow","noopener","noreferrer","_blank","\n","div","nuxt-content-highlight","pre","line-numbers","h2","{","}","\n        ","builtin","h1","function","**","[","\n                    ","]","\n\n    ","if","user","language-shell","language-python","def","\n            ","\n    ","==","number","img","пример-login-button","Пример Login button","bot"," и ","web","message","\"login\"","async","-","\u003E","\u002Flogin","data","sha256","encode","'utf-8'","dict","items","return","raise"," HTTPException","401"," detail","strong","перед запуском проверьте переменные среды","host_url","2021-06-23T15:27:53.658Z")));